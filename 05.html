<!DOCTYPE HTML>
<html lang="en" class="light" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>How to Filter Traffic</title>


        <!-- Custom HTML head -->
        
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="icon" href="favicon.svg">
        <link rel="shortcut icon" href="favicon.png">
        <link rel="stylesheet" href="css/variables.css">
        <link rel="stylesheet" href="css/general.css">
        <link rel="stylesheet" href="css/chrome.css">
        <link rel="stylesheet" href="css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="highlight.css">
        <link rel="stylesheet" href="tomorrow-night.css">
        <link rel="stylesheet" href="ayu-highlight.css">

        <!-- Custom theme stylesheets -->

    </head>
    <body class="sidebar-visible no-js">
    <div id="body-container">
        <!-- Provide site root to javascript -->
        <script>
            var path_to_root = "";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('light')
            html.classList.add(theme);
            var body = document.querySelector('body');
            body.classList.remove('no-js')
            body.classList.add('js');
        </script>

        <input type="checkbox" id="sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            var body = document.querySelector('body');
            var sidebar = null;
            var sidebar_toggle = document.getElementById("sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
            }
            sidebar_toggle.checked = sidebar === 'visible';
            body.classList.remove('sidebar-visible');
            body.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded "><a href="01.html"><strong aria-hidden="true">1.</strong> Introduction</a></li><li class="chapter-item expanded "><a href="02.html"><strong aria-hidden="true">2.</strong> How to Capture Network Traffic</a></li><li class="chapter-item expanded "><a href="03.html"><strong aria-hidden="true">3.</strong> Capturing Packets with Dumpcap</a></li><li class="chapter-item expanded "><a href="04.html"><strong aria-hidden="true">4.</strong> Where to Capture Network Traffic and How</a></li><li class="chapter-item expanded "><a href="05.html" class="active"><strong aria-hidden="true">5.</strong> How to Filter Traffic</a></li><li class="chapter-item expanded "><a href="06.html"><strong aria-hidden="true">6.</strong> Name Resolution</a></li><li class="chapter-item expanded "><a href="07.html"><strong aria-hidden="true">7.</strong> Utilizing the Time Column</a></li><li class="chapter-item expanded "><a href="08.html"><strong aria-hidden="true">8.</strong> Reading PCAPs with Wireshark Statistics</a></li><li class="chapter-item expanded "><a href="09.html"><strong aria-hidden="true">9.</strong> Extracting Files from PCAPs with Wireshark</a></li><li class="chapter-item expanded "><a href="10.html"><strong aria-hidden="true">10.</strong> Map IP Address Locations with Wireshark Using GeoIP</a></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle">
                <div class="sidebar-resize-indicator"></div>
            </div>
        </nav>

        <!-- Track and set sidebar scroll position -->
        <script>
            var sidebarScrollbox = document.querySelector('#sidebar .sidebar-scrollbox');
            sidebarScrollbox.addEventListener('click', function(e) {
                if (e.target.tagName === 'A') {
                    sessionStorage.setItem('sidebar-scroll', sidebarScrollbox.scrollTop);
                }
            }, { passive: true });
            var sidebarScrollTop = sessionStorage.getItem('sidebar-scroll');
            sessionStorage.removeItem('sidebar-scroll');
            if (sidebarScrollTop) {
                // preserve sidebar scroll position when navigating via links within sidebar
                sidebarScrollbox.scrollTop = sidebarScrollTop;
            } else {
                // scroll sidebar to current active section when navigating via "next/previous chapter" buttons
                var activeSection = document.querySelector('#sidebar .active');
                if (activeSection) {
                    activeSection.scrollIntoView({ block: 'center' });
                }
            }
        </script>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="sidebar-toggle" class="icon-button" for="sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </label>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title"></h1>

                    <div class="right-buttons">
                        <a href="print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="how-to-filter-traffic"><a class="header" href="#how-to-filter-traffic">How to Filter Traffic</a></h1>
<h2 id="introduction-to-wireshark-filtering"><a class="header" href="#introduction-to-wireshark-filtering">Introduction to Wireshark Filtering</a></h2>
<p>Filtering network traffic is a crucial aspect of using Wireshark effectively. The ability to isolate specific packets allows for more precise analysis, which is essential when troubleshooting network issues or analyzing network behavior. In Wireshark, filters are divided into two primary categories: <strong>Capture Filters</strong> and <strong>Display Filters</strong>. Understanding these filters and how to apply them correctly is fundamental for any network analyst.</p>
<h2 id="capture-filters-vs-display-filters"><a class="header" href="#capture-filters-vs-display-filters">Capture Filters vs. Display Filters</a></h2>
<h3 id="capture-filters"><a class="header" href="#capture-filters">Capture Filters</a></h3>
<p>Capture filters are applied before the data is even captured by Wireshark. These filters are set at the network interface level, which means they limit the traffic that Wireshark collects in the first place. This is particularly useful when you need to focus on specific traffic types, such as DNS traffic or traffic from a particular IP address, reducing the amount of data that needs to be stored and analyzed.</p>
<p>For example, to capture only DNS traffic, you would use the following capture filter:</p>
<pre><code class="language-bash">udp port 53
</code></pre>
<p>This filter ensures that only DNS traffic (which typically operates over UDP port 53) is captured, thus reducing the volume of data.</p>
<h3 id="display-filters"><a class="header" href="#display-filters">Display Filters</a></h3>
<p>Display filters, on the other hand, are applied after the traffic has been captured. These filters allow you to isolate specific packets from a larger dataset based on criteria such as protocol type, IP address, or specific packet content. Unlike capture filters, display filters do not reduce the amount of data captured; they only refine what is displayed to the user for analysis.</p>
<p>For example, to display only DNS traffic from the captured data, you would use the following display filter:</p>
<pre><code class="language-bash">dns
</code></pre>
<p>This distinction is critical because applying capture filters incorrectly can lead to missing important traffic, whereas display filters allow you to fine-tune your view of the already captured data.</p>
<h2 id="setting-capture-filters-in-wireshark"><a class="header" href="#setting-capture-filters-in-wireshark">Setting Capture Filters in Wireshark</a></h2>
<p>To set a capture filter in Wireshark:</p>
<ol>
<li>Open Wireshark and select the network interface you wish to monitor.</li>
<li>In the capture filter box, enter the appropriate filter syntax. For example, to capture only DNS traffic, enter <code>udp port 53</code>.</li>
<li>Start the capture session.</li>
</ol>
<p><strong>Important Consideration:</strong> While capture filters are powerful, they can also be risky. If the filter is too specific, you might miss critical packets, such as ICMP messages, which could be crucial in diagnosing network issues. It is generally recommended to avoid overly restrictive capture filters unless you are certain of the specific traffic you need to capture.</p>
<h2 id="setting-display-filters-in-wireshark"><a class="header" href="#setting-display-filters-in-wireshark">Setting Display Filters in Wireshark</a></h2>
<p>Display filters are more flexible and allow for post-capture refinement of the data. Here's how you can set a display filter:</p>
<ol>
<li>Start by capturing some traffic.</li>
<li>Once the capture is complete, enter a display filter in the filter bar at the top of the Wireshark window. For instance, to display only ARP traffic, you would enter <code>arp</code>.</li>
<li>Press <code>Enter</code> to apply the filter.</li>
</ol>
<p>Wireshark also provides a convenient way to build complex filters by right-clicking on a packet and selecting "Apply as Filter" or "Prepare as Filter." This method reduces the need to remember specific filter syntax and helps avoid errors.</p>
<h3 id="filtering-by-ip-address-and-conversation"><a class="header" href="#filtering-by-ip-address-and-conversation">Filtering by IP Address and Conversation</a></h3>
<p>Wireshark allows for filtering based on IP addresses or conversations between specific endpoints. For example, to filter packets sent to and from a particular IP address, use the following syntax:</p>
<pre><code class="language-bash">ip.addr == 192.168.0.23
</code></pre>
<p>To filter a conversation between two endpoints, you can either manually enter the filter:</p>
<pre><code class="language-bash">ip.addr == 192.168.0.23 &amp;&amp; ip.addr == 134.10.0.1
</code></pre>
<p>Or you can right-click a packet, select "Conversation Filter," and choose the appropriate layer (e.g., IP, TCP).</p>
<h3 id="complex-filtering-combining-filters"><a class="header" href="#complex-filtering-combining-filters">Complex Filtering: Combining Filters</a></h3>
<p>You can create more complex filters by combining multiple criteria. For example, to filter for TCP traffic on specific ports, use:</p>
<pre><code class="language-bash">tcp.port == 80 || tcp.port == 443 || tcp.port == 8080
</code></pre>
<p>This filter shows all TCP traffic on ports 80, 443, and 8080.</p>
<h3 id="excluding-traffic"><a class="header" href="#excluding-traffic">Excluding Traffic</a></h3>
<p>Sometimes, excluding certain traffic types is necessary to focus on the relevant data. You can use the <code>not</code> keyword to exclude packets. For example, to exclude ARP traffic:</p>
<pre><code class="language-bash">not arp
</code></pre>
<p>Or, to exclude both ARP and IPv6 traffic:</p>
<pre><code class="language-bash">not (arp || ipv6)
</code></pre>
<p>This exclusion technique is helpful when refining the dataset to focus on specific protocols or issues.</p>
<h3 id="filtering-by-string-or-regex"><a class="header" href="#filtering-by-string-or-regex">Filtering by String or Regex</a></h3>
<p>Wireshark supports filtering based on specific strings or regular expressions within packet data. This is particularly useful when searching for specific content within the payloads of captured packets.</p>
<p>To filter by a specific string, use the <code>contains</code> keyword. For example, to find packets containing the string "google":</p>
<pre><code class="language-bash">frame contains "google"
</code></pre>
<p>If you need a case-insensitive search or more complex pattern matching, use <code>matches</code> instead of <code>contains</code>:</p>
<pre><code class="language-bash">frame matches "(?i)google"
</code></pre>
<p><strong>Note:</strong> Be cautious when using string or regex filters, especially with encrypted traffic, as much of the payload data may be encrypted and not visible in clear text.</p>
<h2 id="best-practices-for-using-filters-in-wireshark"><a class="header" href="#best-practices-for-using-filters-in-wireshark">Best Practices for Using Filters in Wireshark</a></h2>
<ol>
<li><strong>Use Capture Filters Sparingly:</strong> Only apply capture filters when you are certain about the specific traffic you need to capture. Avoid overly restrictive capture filters that might lead to missing critical data.</li>
<li><strong>Leverage Display Filters:</strong> After capturing traffic, use display filters to narrow down the dataset for analysis. This approach provides more flexibility and helps prevent the loss of important packets.</li>
<li><strong>Progressively Refine Filters:</strong> Start with broad filters and progressively refine them by excluding irrelevant traffic. This method helps in focusing on the most pertinent data while minimizing noise.</li>
<li><strong>Use Right-Click Filtering:</strong> Utilize Wireshark’s right-click filtering options to build complex filters without manually typing complex syntax. This reduces errors and simplifies the process.</li>
<li><strong>Consider Encryption:</strong> Be aware that many modern protocols use encryption, which can limit the effectiveness of string or regex-based filters. Decrypt traffic when possible for more detailed analysis.</li>
</ol>
<h2 id="conclusion"><a class="header" href="#conclusion">Conclusion</a></h2>
<p>Filtering is a powerful tool in Wireshark that allows for precise network traffic analysis. Understanding the difference between capture and display filters, knowing how to apply them effectively, and following best practices are crucial skills for any network analyst or software developer. As you gain more experience with Wireshark, you'll be able to create more complex filters tailored to your specific needs, enabling you to analyze network traffic with greater accuracy and efficiency.</p>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="04.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next prefetch" href="06.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="04.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next prefetch" href="06.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>




        <script>
            window.playground_copyable = true;
        </script>


        <script src="elasticlunr.min.js"></script>
        <script src="mark.min.js"></script>
        <script src="searcher.js"></script>

        <script src="clipboard.min.js"></script>
        <script src="highlight.js"></script>
        <script src="book.js"></script>

        <!-- Custom JS scripts -->


    </div>
    </body>
</html>
