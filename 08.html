<!DOCTYPE HTML>
<html lang="en" class="light" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Reading PCAPs with Wireshark Statistics</title>


        <!-- Custom HTML head -->
        
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="icon" href="favicon.svg">
        <link rel="shortcut icon" href="favicon.png">
        <link rel="stylesheet" href="css/variables.css">
        <link rel="stylesheet" href="css/general.css">
        <link rel="stylesheet" href="css/chrome.css">
        <link rel="stylesheet" href="css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="highlight.css">
        <link rel="stylesheet" href="tomorrow-night.css">
        <link rel="stylesheet" href="ayu-highlight.css">

        <!-- Custom theme stylesheets -->

    </head>
    <body class="sidebar-visible no-js">
    <div id="body-container">
        <!-- Provide site root to javascript -->
        <script>
            var path_to_root = "";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('light')
            html.classList.add(theme);
            var body = document.querySelector('body');
            body.classList.remove('no-js')
            body.classList.add('js');
        </script>

        <input type="checkbox" id="sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            var body = document.querySelector('body');
            var sidebar = null;
            var sidebar_toggle = document.getElementById("sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
            }
            sidebar_toggle.checked = sidebar === 'visible';
            body.classList.remove('sidebar-visible');
            body.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded "><a href="01.html"><strong aria-hidden="true">1.</strong> Introduction</a></li><li class="chapter-item expanded "><a href="02.html"><strong aria-hidden="true">2.</strong> How to Capture Network Traffic</a></li><li class="chapter-item expanded "><a href="03.html"><strong aria-hidden="true">3.</strong> Capturing Packets with Dumpcap</a></li><li class="chapter-item expanded "><a href="04.html"><strong aria-hidden="true">4.</strong> Where to Capture Network Traffic and How</a></li><li class="chapter-item expanded "><a href="05.html"><strong aria-hidden="true">5.</strong> How to Filter Traffic</a></li><li class="chapter-item expanded "><a href="06.html"><strong aria-hidden="true">6.</strong> Name Resolution</a></li><li class="chapter-item expanded "><a href="07.html"><strong aria-hidden="true">7.</strong> Utilizing the Time Column</a></li><li class="chapter-item expanded "><a href="08.html" class="active"><strong aria-hidden="true">8.</strong> Reading PCAPs with Wireshark Statistics</a></li><li class="chapter-item expanded "><a href="09.html"><strong aria-hidden="true">9.</strong> Extracting Files from PCAPs with Wireshark</a></li><li class="chapter-item expanded "><a href="10.html"><strong aria-hidden="true">10.</strong> Map IP Address Locations with Wireshark Using GeoIP</a></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle">
                <div class="sidebar-resize-indicator"></div>
            </div>
        </nav>

        <!-- Track and set sidebar scroll position -->
        <script>
            var sidebarScrollbox = document.querySelector('#sidebar .sidebar-scrollbox');
            sidebarScrollbox.addEventListener('click', function(e) {
                if (e.target.tagName === 'A') {
                    sessionStorage.setItem('sidebar-scroll', sidebarScrollbox.scrollTop);
                }
            }, { passive: true });
            var sidebarScrollTop = sessionStorage.getItem('sidebar-scroll');
            sessionStorage.removeItem('sidebar-scroll');
            if (sidebarScrollTop) {
                // preserve sidebar scroll position when navigating via links within sidebar
                sidebarScrollbox.scrollTop = sidebarScrollTop;
            } else {
                // scroll sidebar to current active section when navigating via "next/previous chapter" buttons
                var activeSection = document.querySelector('#sidebar .active');
                if (activeSection) {
                    activeSection.scrollIntoView({ block: 'center' });
                }
            }
        </script>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="sidebar-toggle" class="icon-button" for="sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </label>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title"></h1>

                    <div class="right-buttons">
                        <a href="print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="reading-pcaps-with-wireshark-statistics"><a class="header" href="#reading-pcaps-with-wireshark-statistics">Reading PCAPs with Wireshark Statistics</a></h1>
<p>This tutorial will provide an in-depth explanation of how to effectively utilize Wireshark's statistical tools to analyze PCAP (Packet Capture) files. The focus is on how to extract meaningful insights from large data sets without manually sifting through each packet. The methods described will allow you to quickly identify patterns, anomalies, and potential security threats in network traffic.</p>
<h2 id="understanding-the-importance-of-wireshark-statistics"><a class="header" href="#understanding-the-importance-of-wireshark-statistics">Understanding the Importance of Wireshark Statistics</a></h2>
<p>When analyzing network traffic with Wireshark, the volume of data can be overwhelming. PCAP files often contain thousands or even millions of packets, each with multiple layers of information. Manually inspecting every packet is neither practical nor efficient. Instead, Wireshark provides statistical tools that give a high-level overview of the data, enabling a more targeted and effective analysis.</p>
<h2 id="getting-started-with-wireshark-statistics"><a class="header" href="#getting-started-with-wireshark-statistics">Getting Started with Wireshark Statistics</a></h2>
<p>Upon opening a PCAP file in Wireshark, the first step should be to obtain a broad overview of the network traffic. This can be achieved by using the <code>Statistics</code> menu, specifically the <code>Conversations</code> option. Conversations in Wireshark refer to the communication exchanges between two endpoints at different layers of the OSI model, such as Ethernet (Layer 2), IPv4/IPv6 (Layer 3), and TCP/UDP (Layer 4).</p>
<h3 id="accessing-the-conversations-statistics"><a class="header" href="#accessing-the-conversations-statistics">Accessing the Conversations Statistics</a></h3>
<p>To view the conversations within a trace file:</p>
<ol>
<li><strong>Open the PCAP file</strong> in Wireshark.</li>
<li>Navigate to the <strong>Statistics</strong> menu.</li>
<li>Select <strong>Conversations</strong> from the drop-down menu.</li>
</ol>
<p>This opens a window displaying the conversations at different layers:</p>
<ul>
<li><strong>Ethernet</strong>: Displays MAC address-level conversations.</li>
<li><strong>IPv4/IPv6</strong>: Displays IP address-level conversations.</li>
<li><strong>TCP/UDP</strong>: Displays port-level conversations.</li>
</ul>
<h2 id="interpreting-ethernet-layer-conversations"><a class="header" href="#interpreting-ethernet-layer-conversations">Interpreting Ethernet Layer Conversations</a></h2>
<p>At the Ethernet layer, you will typically see a small number of conversations, as it only involves communication between MAC addresses. The most common scenario is a device communicating with its gateway, though other internal communications may also be observed. The primary metrics to consider at this layer are the number of packets and bytes exchanged.</p>
<h2 id="analyzing-ipv4-conversations"><a class="header" href="#analyzing-ipv4-conversations">Analyzing IPv4 Conversations</a></h2>
<p>IPv4 (or IPv6) conversations are more complex, as they involve multiple IP addresses communicating across the network. The conversations window provides critical information, including:</p>
<ul>
<li><strong>Source and Destination IP Addresses</strong>: Identifies the endpoints.</li>
<li><strong>Number of Packets</strong>: Indicates the volume of traffic between these endpoints.</li>
<li><strong>Number of Bytes</strong>: Reflects the amount of data exchanged.</li>
<li><strong>Relative Start and Duration</strong>: Shows when the conversation started and how long it lasted relative to the entire capture.</li>
</ul>
<p>These metrics are invaluable for identifying potential issues. For example, a high number of packets in a short time could indicate a scanning activity or a Distributed Denial of Service (DDoS) attack.</p>
<h2 id="detecting-anomalous-behavior-example-of-a-port-scan"><a class="header" href="#detecting-anomalous-behavior-example-of-a-port-scan">Detecting Anomalous Behavior: Example of a Port Scan</a></h2>
<p>By examining the TCP layer conversations, it is possible to detect unusual activities such as port scans. In the provided example, a large number of TCP conversations with a minimal number of packets per conversation were observed, suggesting that a port scan was being conducted. The characteristics of the scan, such as non-sequential port access, indicate an attempt to evade detection.</p>
<p>To further investigate:</p>
<ol>
<li>Sort the conversations by the <strong>number of packets</strong> or <strong>port numbers</strong>.</li>
<li>Look for patterns, such as the sequential increase in port numbers, which could suggest scanning behavior.</li>
</ol>
<p>The conversation's summary will reveal the source of the scan and the range of ports being targeted, providing a clear indication of potential security threats.</p>
<h2 id="identifying-high-volume-data-transfers"><a class="header" href="#identifying-high-volume-data-transfers">Identifying High-Volume Data Transfers</a></h2>
<p>In scenarios where you are interested in identifying large data transfers, sorting the IPv4 conversations by <strong>bytes exchanged</strong> can be highly effective. This allows you to pinpoint the conversations responsible for significant data transfers, which could be indicative of a backup operation, data exfiltration, or other large file transfers.</p>
<p>To filter the data:</p>
<ol>
<li>Right-click on the desired conversation.</li>
<li>Select <strong>Apply as Filter &gt; Selected</strong>.</li>
<li>This action filters the trace to display only the packets associated with that conversation.</li>
</ol>
<p>This method is useful in various network troubleshooting scenarios, such as diagnosing slow file transfers or detecting unauthorized data movements.</p>
<h2 id="conclusion"><a class="header" href="#conclusion">Conclusion</a></h2>
<p>Using Wireshark's statistical tools is essential for efficient network analysis. By leveraging the <code>Conversations</code> statistics, you can quickly gain a comprehensive view of network activity, identify suspicious patterns, and focus your analysis on the most relevant data. This approach not only saves time but also enhances the accuracy of your network diagnostics.</p>
<p>Always begin your analysis by exploring the high-level statistics provided by Wireshark. This will guide you toward the areas of interest within the capture file, allowing for a more focused and effective investigation.</p>
<p>This concludes the tutorial on reading PCAP files with Wireshark statistics. For further exploration of Wireshark’s capabilities, continue with the next lesson in the series.</p>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="07.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next prefetch" href="09.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="07.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next prefetch" href="09.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>




        <script>
            window.playground_copyable = true;
        </script>


        <script src="elasticlunr.min.js"></script>
        <script src="mark.min.js"></script>
        <script src="searcher.js"></script>

        <script src="clipboard.min.js"></script>
        <script src="highlight.js"></script>
        <script src="book.js"></script>

        <!-- Custom JS scripts -->


    </div>
    </body>
</html>
