<!DOCTYPE HTML>
<html lang="en" class="light" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Capturing Packets with Dumpcap</title>


        <!-- Custom HTML head -->
        
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="icon" href="favicon.svg">
        <link rel="shortcut icon" href="favicon.png">
        <link rel="stylesheet" href="css/variables.css">
        <link rel="stylesheet" href="css/general.css">
        <link rel="stylesheet" href="css/chrome.css">
        <link rel="stylesheet" href="css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="highlight.css">
        <link rel="stylesheet" href="tomorrow-night.css">
        <link rel="stylesheet" href="ayu-highlight.css">

        <!-- Custom theme stylesheets -->

    </head>
    <body class="sidebar-visible no-js">
    <div id="body-container">
        <!-- Provide site root to javascript -->
        <script>
            var path_to_root = "";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('light')
            html.classList.add(theme);
            var body = document.querySelector('body');
            body.classList.remove('no-js')
            body.classList.add('js');
        </script>

        <input type="checkbox" id="sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            var body = document.querySelector('body');
            var sidebar = null;
            var sidebar_toggle = document.getElementById("sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
            }
            sidebar_toggle.checked = sidebar === 'visible';
            body.classList.remove('sidebar-visible');
            body.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded "><a href="01.html"><strong aria-hidden="true">1.</strong> Introduction</a></li><li class="chapter-item expanded "><a href="02.html"><strong aria-hidden="true">2.</strong> How to Capture Network Traffic</a></li><li class="chapter-item expanded "><a href="03.html" class="active"><strong aria-hidden="true">3.</strong> Capturing Packets with Dumpcap</a></li><li class="chapter-item expanded "><a href="04.html"><strong aria-hidden="true">4.</strong> Where to Capture Network Traffic and How</a></li><li class="chapter-item expanded "><a href="05.html"><strong aria-hidden="true">5.</strong> How to Filter Traffic</a></li><li class="chapter-item expanded "><a href="06.html"><strong aria-hidden="true">6.</strong> Name Resolution</a></li><li class="chapter-item expanded "><a href="07.html"><strong aria-hidden="true">7.</strong> Utilizing the Time Column</a></li><li class="chapter-item expanded "><a href="08.html"><strong aria-hidden="true">8.</strong> Reading PCAPs with Wireshark Statistics</a></li><li class="chapter-item expanded "><a href="09.html"><strong aria-hidden="true">9.</strong> Extracting Files from PCAPs with Wireshark</a></li><li class="chapter-item expanded "><a href="10.html"><strong aria-hidden="true">10.</strong> Map IP Address Locations with Wireshark Using GeoIP</a></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle">
                <div class="sidebar-resize-indicator"></div>
            </div>
        </nav>

        <!-- Track and set sidebar scroll position -->
        <script>
            var sidebarScrollbox = document.querySelector('#sidebar .sidebar-scrollbox');
            sidebarScrollbox.addEventListener('click', function(e) {
                if (e.target.tagName === 'A') {
                    sessionStorage.setItem('sidebar-scroll', sidebarScrollbox.scrollTop);
                }
            }, { passive: true });
            var sidebarScrollTop = sessionStorage.getItem('sidebar-scroll');
            sessionStorage.removeItem('sidebar-scroll');
            if (sidebarScrollTop) {
                // preserve sidebar scroll position when navigating via links within sidebar
                sidebarScrollbox.scrollTop = sidebarScrollTop;
            } else {
                // scroll sidebar to current active section when navigating via "next/previous chapter" buttons
                var activeSection = document.querySelector('#sidebar .active');
                if (activeSection) {
                    activeSection.scrollIntoView({ block: 'center' });
                }
            }
        </script>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="sidebar-toggle" class="icon-button" for="sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </label>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title"></h1>

                    <div class="right-buttons">
                        <a href="print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="capturing-packets-with-dumpcap"><a class="header" href="#capturing-packets-with-dumpcap">Capturing Packets with Dumpcap</a></h1>
<h2 id="introduction"><a class="header" href="#introduction">Introduction</a></h2>
<p>In this lesson, we will delve into the command-line tools available in Wireshark, specifically focusing on capturing network packets using <code>dumpcap</code>. Understanding how to use command-line tools is essential for scenarios where the graphical user interface (GUI) of Wireshark may not be ideal, such as remote systems, headless environments, or when scripting automated tasks. This tutorial will guide you through accessing these tools on both Windows and macOS, configuring your system paths, and utilizing various <code>dumpcap</code> options to capture and manage network traffic.</p>
<h2 id="command-line-tools-overview"><a class="header" href="#command-line-tools-overview">Command-Line Tools Overview</a></h2>
<p>When Wireshark is installed, several command-line tools are included. Among these are:</p>
<ul>
<li><strong>dumpcap</strong>: Captures network traffic and saves it to a file.</li>
<li><strong>tshark</strong>: A network protocol analyzer that displays and saves packet data in human-readable form.</li>
<li><strong>mergecap</strong>: Merges multiple capture files into one.</li>
<li><strong>editcap</strong>: Modifies capture files, such as cutting packets or splitting files.</li>
</ul>
<p>In this lesson, our focus will be on <code>dumpcap</code> due to its efficient packet capturing capabilities, which make it more suitable for high-throughput environments compared to the GUI.</p>
<h2 id="accessing-command-line-tools"><a class="header" href="#accessing-command-line-tools">Accessing Command-Line Tools</a></h2>
<h3 id="windows"><a class="header" href="#windows">Windows</a></h3>
<p>To access command-line tools on a Windows system:</p>
<ol>
<li>
<p><strong>Open the Command Prompt</strong>:</p>
<ul>
<li>Press <code>Win + R</code>, type <code>cmd</code>, and press <code>Enter</code>.</li>
</ul>
</li>
<li>
<p><strong>Navigate to the Wireshark Directory</strong>:</p>
<ul>
<li>
<p>If Wireshark's directory is not added to your system's <code>PATH</code> environment variable, you'll need to navigate to it manually. For instance:</p>
<pre><code class="language-sh">cd "C:\Program Files\Wireshark"
</code></pre>
</li>
<li>
<p>Alternatively, you can add Wireshark's directory to your <code>PATH</code> environment variable to access these tools globally:</p>
<ul>
<li>Open Control Panel &gt; System and Security &gt; System.</li>
<li>Click on <strong>Advanced system settings</strong>.</li>
<li>In the <strong>System Properties</strong> window, click <strong>Environment Variables</strong>.</li>
<li>Under <strong>System variables</strong>, select <code>Path</code>, and click <strong>Edit</strong>.</li>
<li>Add the Wireshark directory path (e.g., <code>C:\Program Files\Wireshark</code>).</li>
</ul>
</li>
</ul>
</li>
<li>
<p><strong>Verify Access</strong>:</p>
<ul>
<li>Once the path is set, you can type <code>dumpcap -h</code> in any command prompt to verify that the tools are accessible.</li>
</ul>
</li>
</ol>
<h3 id="macos"><a class="header" href="#macos">macOS</a></h3>
<p>On macOS, the process is similar but involves the Terminal:</p>
<ol>
<li>
<p><strong>Open Terminal</strong>:</p>
<ul>
<li>You can find Terminal in <code>Applications &gt; Utilities</code> or by using Spotlight search (<code>Cmd + Space</code>).</li>
</ul>
</li>
<li>
<p><strong>Locate Wireshark Tools</strong>:</p>
<ul>
<li>
<p>The Wireshark tools are typically installed in:</p>
<pre><code class="language-sh">/Applications/Wireshark.app/Contents/MacOS/
</code></pre>
</li>
</ul>
</li>
<li>
<p><strong>Modify the Path</strong>:</p>
<ul>
<li>
<p>Temporarily add the directory to your path:</p>
<pre><code class="language-sh">export PATH=$PATH:/Applications/Wireshark.app/Contents/MacOS/
</code></pre>
</li>
<li>
<p>To make this change permanent, you can add the above line to your <code>~/.bash_profile</code>, <code>~/.zshrc</code>, or equivalent shell configuration file.</p>
</li>
</ul>
</li>
<li>
<p><strong>Verify Access</strong>:</p>
<ul>
<li>Test by typing <code>dumpcap -h</code> to ensure the tools are properly accessible from the command line.</li>
</ul>
</li>
</ol>
<h2 id="using-dumpcap-to-capture-packets"><a class="header" href="#using-dumpcap-to-capture-packets">Using Dumpcap to Capture Packets</a></h2>
<h3 id="basic-usage"><a class="header" href="#basic-usage">Basic Usage</a></h3>
<p>To begin capturing packets using <code>dumpcap</code>, follow these steps:</p>
<ol>
<li>
<p><strong>List Network Interfaces</strong>:</p>
<ul>
<li>
<p>Before capturing, it's crucial to know which network interface you want to monitor. Use the <code>-D</code> option to list all available interfaces:</p>
<pre><code class="language-sh">dumpcap -D
</code></pre>
</li>
<li>
<p>This command will return a list of interfaces with their corresponding index numbers, which you'll use in subsequent commands.</p>
</li>
</ul>
</li>
<li>
<p><strong>Start a Basic Capture</strong>:</p>
<ul>
<li>
<p>To start capturing on a specific interface (e.g., interface 1):</p>
<pre><code class="language-sh">dumpcap -i 1
</code></pre>
</li>
<li>
<p>By default, <code>dumpcap</code> will start capturing packets and saving them to a temporary directory. You can stop the capture by pressing <code>Ctrl + C</code>.</p>
</li>
</ul>
</li>
</ol>
<h3 id="saving-captures-to-a-specific-location"><a class="header" href="#saving-captures-to-a-specific-location">Saving Captures to a Specific Location</a></h3>
<p>To specify where the capture files should be saved:</p>
<ol>
<li>
<p><strong>Specify Output File</strong>:</p>
<ul>
<li>
<p>Use the <code>-w</code> option to define the path and filename for the output:</p>
<pre><code class="language-sh">dumpcap -i 1 -w /Users/username/data/sample.pcapng
</code></pre>
</li>
</ul>
</li>
<li>
<p><strong>Confirm Capture</strong>:</p>
<ul>
<li>Upon running this command, <code>dumpcap</code> will save the captured packets to the specified file. The capture will continue until manually stopped with <code>Ctrl + C</code>.</li>
</ul>
</li>
</ol>
<h3 id="using-ring-buffers"><a class="header" href="#using-ring-buffers">Using Ring Buffers</a></h3>
<p>For long-duration captures or high-traffic environments, a ring buffer is advantageous as it prevents the capture file from growing too large. It splits the capture into smaller, manageable files.</p>
<ol>
<li>
<p><strong>Configure Ring Buffer</strong>:</p>
<ul>
<li>
<p>Use the <code>-b</code> option to set the file size and number of files in the buffer:</p>
<pre><code class="language-sh">dumpcap -i 1 -w /Users/username/data/sample.pcapng -b filesize:500000 -b files:10
</code></pre>
</li>
<li>
<p>In this example:</p>
<ul>
<li><code>filesize:500000</code> specifies a maximum file size of 500MB per file.</li>
<li><code>files:10</code> limits the number of files to 10, after which older files will be overwritten.</li>
</ul>
</li>
</ul>
</li>
<li>
<p><strong>Monitor Ring Buffer Operation</strong>:</p>
<ul>
<li>As <code>dumpcap</code> runs, it creates new files as the data grows. Once the limit is reached, the oldest files are overwritten, ensuring that you always have the most recent data without exceeding disk space.</li>
</ul>
</li>
</ol>
<h2 id="conclusion"><a class="header" href="#conclusion">Conclusion</a></h2>
<p>This tutorial has provided a detailed guide on how to utilize <code>dumpcap</code> for packet capturing via the command line. The use of command-line tools like <code>dumpcap</code> offers greater flexibility and efficiency, particularly in environments where GUI tools may be less practical. Understanding and using these tools is crucial for network analysis, troubleshooting, and security assessments.</p>
<p>By following the instructions outlined in this lesson, you should now be equipped to capture, manage, and analyze network traffic using Wireshark's command-line utilities in a variety of environments.</p>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="02.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next prefetch" href="04.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="02.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next prefetch" href="04.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>




        <script>
            window.playground_copyable = true;
        </script>


        <script src="elasticlunr.min.js"></script>
        <script src="mark.min.js"></script>
        <script src="searcher.js"></script>

        <script src="clipboard.min.js"></script>
        <script src="highlight.js"></script>
        <script src="book.js"></script>

        <!-- Custom JS scripts -->


    </div>
    </body>
</html>
