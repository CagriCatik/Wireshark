<!DOCTYPE HTML>
<html lang="en" class="light" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>How to Capture Network Traffic</title>


        <!-- Custom HTML head -->
        
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="icon" href="favicon.svg">
        <link rel="shortcut icon" href="favicon.png">
        <link rel="stylesheet" href="css/variables.css">
        <link rel="stylesheet" href="css/general.css">
        <link rel="stylesheet" href="css/chrome.css">
        <link rel="stylesheet" href="css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="highlight.css">
        <link rel="stylesheet" href="tomorrow-night.css">
        <link rel="stylesheet" href="ayu-highlight.css">

        <!-- Custom theme stylesheets -->

    </head>
    <body class="sidebar-visible no-js">
    <div id="body-container">
        <!-- Provide site root to javascript -->
        <script>
            var path_to_root = "";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('light')
            html.classList.add(theme);
            var body = document.querySelector('body');
            body.classList.remove('no-js')
            body.classList.add('js');
        </script>

        <input type="checkbox" id="sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            var body = document.querySelector('body');
            var sidebar = null;
            var sidebar_toggle = document.getElementById("sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
            }
            sidebar_toggle.checked = sidebar === 'visible';
            body.classList.remove('sidebar-visible');
            body.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded "><a href="01.html"><strong aria-hidden="true">1.</strong> Introduction</a></li><li class="chapter-item expanded "><a href="02.html" class="active"><strong aria-hidden="true">2.</strong> How to Capture Network Traffic</a></li><li class="chapter-item expanded "><a href="03.html"><strong aria-hidden="true">3.</strong> Capturing Packets with Dumpcap</a></li><li class="chapter-item expanded "><a href="04.html"><strong aria-hidden="true">4.</strong> Where to Capture Network Traffic and How</a></li><li class="chapter-item expanded "><a href="05.html"><strong aria-hidden="true">5.</strong> How to Filter Traffic</a></li><li class="chapter-item expanded "><a href="06.html"><strong aria-hidden="true">6.</strong> Name Resolution</a></li><li class="chapter-item expanded "><a href="07.html"><strong aria-hidden="true">7.</strong> Utilizing the Time Column</a></li><li class="chapter-item expanded "><a href="08.html"><strong aria-hidden="true">8.</strong> Reading PCAPs with Wireshark Statistics</a></li><li class="chapter-item expanded "><a href="09.html"><strong aria-hidden="true">9.</strong> Extracting Files from PCAPs with Wireshark</a></li><li class="chapter-item expanded "><a href="10.html"><strong aria-hidden="true">10.</strong> Map IP Address Locations with Wireshark Using GeoIP</a></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle">
                <div class="sidebar-resize-indicator"></div>
            </div>
        </nav>

        <!-- Track and set sidebar scroll position -->
        <script>
            var sidebarScrollbox = document.querySelector('#sidebar .sidebar-scrollbox');
            sidebarScrollbox.addEventListener('click', function(e) {
                if (e.target.tagName === 'A') {
                    sessionStorage.setItem('sidebar-scroll', sidebarScrollbox.scrollTop);
                }
            }, { passive: true });
            var sidebarScrollTop = sessionStorage.getItem('sidebar-scroll');
            sessionStorage.removeItem('sidebar-scroll');
            if (sidebarScrollTop) {
                // preserve sidebar scroll position when navigating via links within sidebar
                sidebarScrollbox.scrollTop = sidebarScrollTop;
            } else {
                // scroll sidebar to current active section when navigating via "next/previous chapter" buttons
                var activeSection = document.querySelector('#sidebar .active');
                if (activeSection) {
                    activeSection.scrollIntoView({ block: 'center' });
                }
            }
        </script>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="sidebar-toggle" class="icon-button" for="sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </label>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title"></h1>

                    <div class="right-buttons">
                        <a href="print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="how-to-capture-network-traffic"><a class="header" href="#how-to-capture-network-traffic">How to Capture Network Traffic</a></h1>
<h2 id="introduction"><a class="header" href="#introduction">Introduction</a></h2>
<p>In this tutorial, we will delve into the basics of packet capture using Wireshark, a widely used network protocol analyzer. This guide is designed to help you understand how to capture network traffic, interpret different interfaces, and optimize your capture settings. While this tutorial assumes no prior knowledge of Wireshark, it aims to provide comprehensive coverage, ensuring you gain a solid understanding of the tool's functionalities.</p>
<h2 id="understanding-packet-capture-in-wireshark"><a class="header" href="#understanding-packet-capture-in-wireshark">Understanding Packet Capture in Wireshark</a></h2>
<h3 id="1-overview-of-packet-capture"><a class="header" href="#1-overview-of-packet-capture">1. Overview of Packet Capture</a></h3>
<p>Packet capture is the process of intercepting and logging traffic that passes over a digital network. It allows network administrators and engineers to analyze data packets to troubleshoot network issues, monitor network activity, and secure network communications. Wireshark, as a packet analyzer, is a powerful tool that enables users to perform this task efficiently.</p>
<h3 id="2-the-role-of-packet-drivers"><a class="header" href="#2-the-role-of-packet-drivers">2. The Role of Packet Drivers</a></h3>
<p>For Wireshark to capture network traffic, it requires a packet driver to intercept and pass the data to the analyzer. The packet driver acts as a middleman between the network interface and Wireshark, capturing the raw data packets for analysis.</p>
<h4 id="packet-drivers-in-different-operating-systems"><a class="header" href="#packet-drivers-in-different-operating-systems">Packet Drivers in Different Operating Systems</a></h4>
<ul>
<li><strong>macOS</strong>: Wireshark utilizes the <code>libpcap</code> library as the packet driver. You can check the version of <code>libpcap</code> installed by navigating to <code>Wireshark -&gt; About Wireshark</code>.</li>
<li><strong>Windows</strong>: On Windows systems, Wireshark typically uses the <code>npcap</code> library. You can verify its installation in the <code>About Wireshark</code> section under the Help menu.</li>
</ul>
<p>If Wireshark is unable to capture traffic, it might be due to the absence of the required packet driver or insufficient administrative privileges.</p>
<h3 id="3-network-interfaces-in-wireshark"><a class="header" href="#3-network-interfaces-in-wireshark">3. Network Interfaces in Wireshark</a></h3>
<p>Wireshark identifies all available network interfaces on your machine, allowing you to choose the appropriate one for packet capture. These interfaces can include physical connections (such as Ethernet or Wi-Fi) and virtual interfaces (such as those created by VPNs or virtualization software like GNS3).</p>
<h4 id="common-network-interfaces"><a class="header" href="#common-network-interfaces">Common Network Interfaces</a></h4>
<ul>
<li><strong>Physical Interfaces</strong>: These include Ethernet, Wi-Fi, and Thunderbolt connections. Traffic captured on these interfaces will typically be more straightforward to analyze as they correspond to physical connections.</li>
<li><strong>Virtual Interfaces</strong>: VPNs, virtual machines, and other software can create virtual network interfaces, which might appear in Wireshark's interface list.</li>
</ul>
<h3 id="4-managing-network-interfaces"><a class="header" href="#4-managing-network-interfaces">4. Managing Network Interfaces</a></h3>
<p>To simplify the capture process, it is advisable to manage the interfaces that Wireshark actively monitors:</p>
<ul>
<li>Navigate to the capture options by clicking on the gear icon or selecting <code>Capture -&gt; Options</code>.</li>
<li>In the <code>Manage Interfaces</code> section, you can enable or disable interfaces depending on whether you wish to capture traffic on them. This reduces clutter and makes it easier to focus on the relevant interfaces.</li>
</ul>
<h3 id="5-snap-length-and-buffer-size"><a class="header" href="#5-snap-length-and-buffer-size">5. Snap Length and Buffer Size</a></h3>
<h4 id="snap-length"><a class="header" href="#snap-length">Snap Length</a></h4>
<p>Snap length, or snapshot length, defines the maximum amount of data Wireshark captures for each packet. This can be configured to avoid capturing the full payload of a packet, which is useful in secure environments or when you only need specific packet header information.</p>
<ul>
<li><strong>Configuring Snap Length</strong>: You can set the snap length in bytes. For example, a snap length of 64 bytes will capture enough data to include Ethernet, IP, and TCP headers but may exclude the packet's payload.</li>
<li><strong>Caution</strong>: Setting the snap length too low can result in incomplete data captures, which may hinder your analysis.</li>
</ul>
<h4 id="buffer-size"><a class="header" href="#buffer-size">Buffer Size</a></h4>
<p>The buffer size determines the amount of kernel memory allocated for storing captured packets before they are processed by Wireshark. The default setting is typically sufficient, but in high-throughput environments, you may need to adjust this to prevent packet loss.</p>
<h3 id="6-promiscuous-mode"><a class="header" href="#6-promiscuous-mode">6. Promiscuous Mode</a></h3>
<p>Enabling promiscuous mode allows Wireshark to capture all traffic on the network, not just the traffic destined for the host machine. This is essential for thorough network analysis, particularly when diagnosing issues that involve multiple devices on the network.</p>
<h2 id="configuring-output-settings"><a class="header" href="#configuring-output-settings">Configuring Output Settings</a></h2>
<h3 id="1-saving-captured-data"><a class="header" href="#1-saving-captured-data">1. Saving Captured Data</a></h3>
<p>Wireshark allows you to specify where captured data should be saved. It is crucial to manage this setting to avoid overwhelming your storage, especially during long capture sessions.</p>
<h4 id="best-practices"><a class="header" href="#best-practices">Best Practices</a></h4>
<ul>
<li><strong>Limit File Size</strong>: Large capture files (&gt;500 MB) can be cumbersome to analyze. Consider setting a file size limit to keep individual capture files manageable.</li>
<li><strong>Use Multiple Files</strong>: Wireshark can be configured to split the capture into multiple smaller files. This approach is particularly useful for long-term captures or in environments with high network traffic.</li>
</ul>
<h3 id="2-configuring-a-ring-buffer"><a class="header" href="#2-configuring-a-ring-buffer">2. Configuring a Ring Buffer</a></h3>
<p>A ring buffer is an advanced feature that enables Wireshark to continuously capture data into a fixed number of files. Once the specified number of files is reached, Wireshark begins overwriting the oldest file.</p>
<h4 id="example-configuration"><a class="header" href="#example-configuration">Example Configuration</a></h4>
<ul>
<li><strong>File Size</strong>: 500 MB</li>
<li><strong>Number of Files</strong>: 10</li>
</ul>
<p>This configuration will allow Wireshark to capture up to 5 GB of data, spread across 10 files. The oldest file will be overwritten once the 11th file begins, ensuring that only the most recent 5 GB of data is retained.</p>
<h3 id="3-starting-the-capture"><a class="header" href="#3-starting-the-capture">3. Starting the Capture</a></h3>
<p>Before starting the capture, ensure that the correct interface is selected. After selecting the interface and configuring the output settings, you can begin capturing traffic. Wireshark will then generate files according to the settings you have specified.</p>
<h2 id="conclusion"><a class="header" href="#conclusion">Conclusion</a></h2>
<p>This tutorial has provided an in-depth overview of how to capture network traffic using Wireshark. By understanding the importance of packet drivers, managing network interfaces, configuring snap lengths and buffer sizes, and utilizing output settings effectively, you can harness the full potential of Wireshark for network analysis. In the next tutorial, we will explore packet capture using the command line, a crucial skill for advanced network troubleshooting.</p>
<p>This content aims to deliver a thorough understanding of Wireshark's functionalities, adhering to the rigorous standards expected in the field of software development.</p>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="01.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next prefetch" href="03.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="01.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next prefetch" href="03.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>




        <script>
            window.playground_copyable = true;
        </script>


        <script src="elasticlunr.min.js"></script>
        <script src="mark.min.js"></script>
        <script src="searcher.js"></script>

        <script src="clipboard.min.js"></script>
        <script src="highlight.js"></script>
        <script src="book.js"></script>

        <!-- Custom JS scripts -->


    </div>
    </body>
</html>
