<!DOCTYPE HTML>
<html lang="en" class="light" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Extracting Files from PCAPs with Wireshark</title>


        <!-- Custom HTML head -->
        
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="icon" href="favicon.svg">
        <link rel="shortcut icon" href="favicon.png">
        <link rel="stylesheet" href="css/variables.css">
        <link rel="stylesheet" href="css/general.css">
        <link rel="stylesheet" href="css/chrome.css">
        <link rel="stylesheet" href="css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="highlight.css">
        <link rel="stylesheet" href="tomorrow-night.css">
        <link rel="stylesheet" href="ayu-highlight.css">

        <!-- Custom theme stylesheets -->

    </head>
    <body class="sidebar-visible no-js">
    <div id="body-container">
        <!-- Provide site root to javascript -->
        <script>
            var path_to_root = "";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('light')
            html.classList.add(theme);
            var body = document.querySelector('body');
            body.classList.remove('no-js')
            body.classList.add('js');
        </script>

        <input type="checkbox" id="sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            var body = document.querySelector('body');
            var sidebar = null;
            var sidebar_toggle = document.getElementById("sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
            }
            sidebar_toggle.checked = sidebar === 'visible';
            body.classList.remove('sidebar-visible');
            body.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded "><a href="01.html"><strong aria-hidden="true">1.</strong> Introduction</a></li><li class="chapter-item expanded "><a href="02.html"><strong aria-hidden="true">2.</strong> How to Capture Network Traffic</a></li><li class="chapter-item expanded "><a href="03.html"><strong aria-hidden="true">3.</strong> Capturing Packets with Dumpcap</a></li><li class="chapter-item expanded "><a href="04.html"><strong aria-hidden="true">4.</strong> Where to Capture Network Traffic and How</a></li><li class="chapter-item expanded "><a href="05.html"><strong aria-hidden="true">5.</strong> How to Filter Traffic</a></li><li class="chapter-item expanded "><a href="06.html"><strong aria-hidden="true">6.</strong> Name Resolution</a></li><li class="chapter-item expanded "><a href="07.html"><strong aria-hidden="true">7.</strong> Utilizing the Time Column</a></li><li class="chapter-item expanded "><a href="08.html"><strong aria-hidden="true">8.</strong> Reading PCAPs with Wireshark Statistics</a></li><li class="chapter-item expanded "><a href="09.html" class="active"><strong aria-hidden="true">9.</strong> Extracting Files from PCAPs with Wireshark</a></li><li class="chapter-item expanded "><a href="10.html"><strong aria-hidden="true">10.</strong> Map IP Address Locations with Wireshark Using GeoIP</a></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle">
                <div class="sidebar-resize-indicator"></div>
            </div>
        </nav>

        <!-- Track and set sidebar scroll position -->
        <script>
            var sidebarScrollbox = document.querySelector('#sidebar .sidebar-scrollbox');
            sidebarScrollbox.addEventListener('click', function(e) {
                if (e.target.tagName === 'A') {
                    sessionStorage.setItem('sidebar-scroll', sidebarScrollbox.scrollTop);
                }
            }, { passive: true });
            var sidebarScrollTop = sessionStorage.getItem('sidebar-scroll');
            sessionStorage.removeItem('sidebar-scroll');
            if (sidebarScrollTop) {
                // preserve sidebar scroll position when navigating via links within sidebar
                sidebarScrollbox.scrollTop = sidebarScrollTop;
            } else {
                // scroll sidebar to current active section when navigating via "next/previous chapter" buttons
                var activeSection = document.querySelector('#sidebar .active');
                if (activeSection) {
                    activeSection.scrollIntoView({ block: 'center' });
                }
            }
        </script>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="sidebar-toggle" class="icon-button" for="sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </label>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title"></h1>

                    <div class="right-buttons">
                        <a href="print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="extracting-files-from-pcaps-with-wireshark"><a class="header" href="#extracting-files-from-pcaps-with-wireshark">Extracting Files from PCAPs with Wireshark</a></h1>
<h2 id="introduction"><a class="header" href="#introduction">Introduction</a></h2>
<p>In the field of cybersecurity and network analysis, the ability to extract files from packet capture (PCAP) files is a critical skill. This capability is essential for conducting detailed investigations, particularly in scenarios involving capture the flag (CTF) competitions, malware analysis, or network troubleshooting. In this tutorial, we will provide a rigorous, step-by-step guide on how to extract files from PCAPs using Wireshark, a widely-used network protocol analyzer.</p>
<h2 id="prerequisites"><a class="header" href="#prerequisites">Prerequisites</a></h2>
<p>Before proceeding, ensure that you have the following:</p>
<ul>
<li><strong>Wireshark Installed</strong>: The latest version of Wireshark should be installed on your system. You can download it from the <a href="https://www.wireshark.org/download.html">official Wireshark website</a>.</li>
<li><strong>PCAP File</strong>: Obtain the PCAP file that you intend to analyze. For the purpose of this tutorial, a sample PCAP file is assumed.</li>
</ul>
<h2 id="step-1-open-the-pcap-file-in-wireshark"><a class="header" href="#step-1-open-the-pcap-file-in-wireshark">Step 1: Open the PCAP File in Wireshark</a></h2>
<ol>
<li>Launch Wireshark.</li>
<li>Open the PCAP file by navigating to <code>File</code> -&gt; <code>Open</code> and selecting the appropriate file.</li>
<li>Upon opening the file, Wireshark will display the captured network traffic in a three-pane view:
<ul>
<li><strong>Packet List Pane</strong>: Shows a summary of each packet.</li>
<li><strong>Packet Details Pane</strong>: Displays the protocol tree for the selected packet.</li>
<li><strong>Packet Bytes Pane</strong>: Shows the raw data of the selected packet.</li>
</ul>
</li>
</ol>
<h2 id="step-2-analyze-the-traffic-and-identify-the-target-data"><a class="header" href="#step-2-analyze-the-traffic-and-identify-the-target-data">Step 2: Analyze the Traffic and Identify the Target Data</a></h2>
<p>To effectively extract a file, you must first identify the relevant traffic:</p>
<ol>
<li><strong>Identify the Protocol</strong>: Review the traffic to determine which protocol the file transfer occurred over. In many cases, this will be HTTP, but other protocols like SMB or FTP may also be used.</li>
<li><strong>Locate the Transfer</strong>: Identify the specific packets involved in the file transfer. This is typically associated with <code>GET</code> or <code>POST</code> requests in HTTP traffic.</li>
</ol>
<h2 id="step-3-ensure-tcp-reassembly-is-enabled"><a class="header" href="#step-3-ensure-tcp-reassembly-is-enabled">Step 3: Ensure TCP Reassembly is Enabled</a></h2>
<p>Wireshark can reassemble TCP streams, which is crucial for reconstructing files that were transferred across multiple packets.</p>
<ol>
<li>In the <code>Packet Details Pane</code>, expand the TCP layer.</li>
<li>Right-click on TCP and select <code>Protocol Preferences</code>.</li>
<li>Ensure that the option <strong>Allow subdissector to reassemble TCP streams</strong> is enabled. This setting allows Wireshark to reconstruct the full data stream, which is necessary for accurate file extraction.</li>
</ol>
<h2 id="step-4-extract-the-file-using-export-objects"><a class="header" href="#step-4-extract-the-file-using-export-objects">Step 4: Extract the File Using Export Objects</a></h2>
<p>Wireshark provides a feature to export objects from certain protocols, making file extraction straightforward.</p>
<ol>
<li>Navigate to <code>File</code> -&gt; <code>Export Objects</code>.</li>
<li>Select the appropriate protocol. For example:
<ul>
<li><strong>HTTP</strong>: For files transferred over HTTP.</li>
<li><strong>SMB</strong>: For files transferred over SMB.</li>
<li><strong>TFTP</strong>: For files transferred over TFTP.</li>
</ul>
</li>
<li>Wireshark will display a list of objects that it can extract. Identify the file of interest by reviewing the list.</li>
<li>Select the desired file and click <code>Save</code>. Choose a location on your file system to save the extracted file.</li>
</ol>
<h2 id="step-5-verify-the-extracted-file"><a class="header" href="#step-5-verify-the-extracted-file">Step 5: Verify the Extracted File</a></h2>
<p>After extraction, it is essential to verify the integrity and content of the file:</p>
<ol>
<li>Navigate to the location where you saved the file.</li>
<li>Open the file with the appropriate application to ensure it was correctly extracted.</li>
<li>If the file is a binary or executable, exercise caution. Analyze the file in a secure environment to prevent potential malware execution.</li>
</ol>
<h2 id="step-6-manual-extraction-via-tcp-stream-if-necessary"><a class="header" href="#step-6-manual-extraction-via-tcp-stream-if-necessary">Step 6: Manual Extraction via TCP Stream (If Necessary)</a></h2>
<p>In cases where the <code>Export Objects</code> method does not yield results, a manual extraction might be required:</p>
<ol>
<li>Identify the packet associated with the file transfer and right-click on it.</li>
<li>Select <code>Follow</code> -&gt; <code>TCP Stream</code>.</li>
<li>Wireshark will display the entire data exchange for the TCP stream in a new window.</li>
<li>Review the data to identify the beginning and end of the file content.</li>
<li>Use the <code>Save As</code> option to export the raw data, which can then be manually reconstructed into a file using a hex editor or other tools.</li>
</ol>
<h2 id="important-considerations"><a class="header" href="#important-considerations">Important Considerations</a></h2>
<ul>
<li><strong>File Types</strong>: The ability to extract and reconstruct files depends on the file type and protocol used. For instance, HTTP allows for easy extraction, whereas encrypted protocols such as HTTPS require decryption before extraction.</li>
<li><strong>Security</strong>: When dealing with potentially malicious files, always perform the extraction and subsequent analysis in a controlled, isolated environment (e.g., a virtual machine) to mitigate the risk of executing harmful code.</li>
</ul>
<h2 id="conclusion"><a class="header" href="#conclusion">Conclusion</a></h2>
<p>The process of extracting files from PCAP files using Wireshark is a fundamental skill in network analysis and cybersecurity. By following this tutorial, professionals and enthusiasts alike can enhance their ability to analyze network traffic, extract valuable data, and conduct thorough investigations. This capability is not only useful in educational settings, such as CTF competitions, but also in real-world cybersecurity operations.</p>
<p>This tutorial provided a detailed walkthrough of the extraction process, ensuring a scientific and accurate approach to file recovery. Continue to explore and practice with different types of traffic and file transfers to master this essential skill.</p>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="08.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next prefetch" href="10.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="08.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next prefetch" href="10.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>




        <script>
            window.playground_copyable = true;
        </script>


        <script src="elasticlunr.min.js"></script>
        <script src="mark.min.js"></script>
        <script src="searcher.js"></script>

        <script src="clipboard.min.js"></script>
        <script src="highlight.js"></script>
        <script src="book.js"></script>

        <!-- Custom JS scripts -->


    </div>
    </body>
</html>
